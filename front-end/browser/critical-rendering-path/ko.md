# 브라우저 렌더링 과정

1. HTML 파싱
2. 렌더 트리 (Render Tree) 구성
3. 레이아웃 (Layout)
4. 페인트 (Paint)
5. 합성 (Composite)

## HTML 파싱

![](./parse-html.png)

페이지를 렌더링하기 위한 가장 첫 단계는 HTML을 파싱하는 것이다.

이때 HTML을 이루는 element, text에 대한 노드로 이루어진 DOM 트리가 만들어지게 된다.

그 과정에서 CSS도 파싱되어 CSSOM이라는 DOM과 같은 트리가 만들어진다.

또한 JavaScript도 실행되는데, 이때 JavaScript는 HTML 파싱을 차단하는 리소스이다. 왜냐하면 DOM, CSSOM을 조작할 수 있기 때문이다.

## 렌더 트리 (Render Tree) 구성

![](./create-render-tree.png)

`HTML 파싱` 단계 이후, 완전히 구성된 DOM과 CSSOM을 합쳐 렌더 트리를 구성하게 된다.

렌더 트리는 실제로 화면에 그려질 것들만 모아놓은 트리이다. 예를 들어, `display: none`인 element들은 렌더 트리에서 제외된다.

## 레이아웃 (Layout)

렌더 트리가 구성은 되었지만, 렌더 트리의 각 요소들이 어떤 순서로, 어떤 크기로, 어떤 위치에 렌더링될 것인지는 아직 모른다.

`레이아웃` 단계는 렌더 트리를 순회하며 그 정보를 계산하는 단계이다.

## 페인트 (Paint)

`페인트` 단계는 `레이아웃` 단계에서 계산된 정보를 통해 렌더 트리의 노드를 실제 화면상에 렌더링될 픽셀로 변환한다.

이때 모던 브라우저에서는 렌더 트리 전체를 통으로 페인트하지 않고, 여러 레이어로 나누어 관리한다.

## 합성 (Composite)

`합성` 단계에서는 `페인트` 단계에서 만들어진 레이어를 합쳐 화면에 실제로 렌더링한다.

여담으로 Chrome 개발자 도구에서는 `Layers`라는 도구가 숨겨져 있는데, (`... > More tools > Layers`를 선택하여 활성화 가능) 거기서 레이어가 실제로 어떻게 나뉘어 페이지를 구성하고 있는지 시각화하여 볼 수 있다.
